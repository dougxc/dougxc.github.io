<?xml version="1.0"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head><meta charset="utf-8">
<meta http-equiv="cache-control" content="no-cache" />
<meta http-equiv="Pragma" content="no-cache" />
<meta http-equiv="Expires" content="-1" />
<!--
   Note to customizers: the body of the webrev is IDed as SUNWwebrev
   to allow easy overriding by users of webrev via the userContent.css
   mechanism available in some browsers.

   For example, to have all "removed" information be red instead of
   brown, set a rule in your userContent.css file like:

       body#SUNWwebrev span.removed { color: red ! important; }
-->
<style type="text/css" media="screen">
body {
    background-color: #eeeeee;
}
hr {
    border: none 0;
    border-top: 1px solid #aaa;
    height: 1px;
}
div.summary {
    font-size: .8em;
    border-bottom: 1px solid #aaa;
    padding-left: 1em;
    padding-right: 1em;
}
div.summary h2 {
    margin-bottom: 0.3em;
}
div.summary table th {
    text-align: right;
    vertical-align: top;
    white-space: nowrap;
}
span.lineschanged {
    font-size: 0.7em;
}
span.oldmarker {
    color: red;
    font-size: large;
    font-weight: bold;
}
span.newmarker {
    color: green;
    font-size: large;
    font-weight: bold;
}
span.removed {
    color: brown;
}
span.changed {
    color: blue;
}
span.new {
    color: blue;
    font-weight: bold;
}
a.print { font-size: x-small; }

</style>

<style type="text/css" media="print">
pre { font-size: 0.8em; font-family: courier, monospace; }
span.removed { color: #444; font-style: italic }
span.changed { font-weight: bold; }
span.new { font-weight: bold; }
span.newmarker { font-size: 1.2em; font-weight: bold; }
span.oldmarker { font-size: 1.2em; font-weight: bold; }
a.print {display: none}
hr { border: none 0; border-top: 1px solid #aaa; height: 1px; }
</style>

    <script type="text/javascript" src="../../ancnav.js"></script>
    </head>
    <body id="SUNWwebrev" onkeypress="keypress(event);">
    <a name="0"></a>
    <pre></pre><hr></hr>
<pre>
   1 #
   2 # Copyright (c) 2014, 2018, Oracle and/or its affiliates. All rights reserved.
   3 # DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
   4 #
   5 # This code is free software; you can redistribute it and/or modify it
   6 # under the terms of the GNU General Public License version 2 only, as
   7 # published by the Free Software Foundation.  Oracle designates this
   8 # particular file as subject to the "Classpath" exception as provided
   9 # by Oracle in the LICENSE file that accompanied this code.
  10 #
  11 # This code is distributed in the hope that it will be useful, but WITHOUT
  12 # ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
  13 # FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License
  14 # version 2 for more details (a copy is included in the LICENSE file that
  15 # accompanied this code).
  16 #
  17 # You should have received a copy of the GNU General Public License version
  18 # 2 along with this work; if not, write to the Free Software Foundation,
  19 # Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.
  20 #
  21 # Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA
  22 # or visit www.oracle.com if you need additional information or have any
  23 # questions.
  24 #
  25 
  26 ifndef _MODULES_GMK
  27 _MODULES_GMK := 1
  28 
  29 ################################################################################
  30 #
  31 # BOOT_MODULES are modules defined by the boot loader
  32 # PLATFORM_MODULES are modules defined by the platform loader
  33 # JRE_TOOL_MODULES are tools included in JRE and defined by the application loader
  34 #
  35 # All other modules not declared below are defined by the application loader
  36 # and are not included in JRE.
  37 
  38 BOOT_MODULES :=
  39 PLATFORM_MODULES :=
  40 JRE_TOOL_MODULES :=
  41 UPGRADEABLE_MODULES :=
  42 AGGREGATOR_MODULES :=
  43 DOCS_MODULES :=
  44 
  45 # Hook to include the corresponding custom file, if present.
  46 $(eval $(call IncludeCustomExtension, common/Modules.gmk))
  47 
  48 BOOT_MODULES += \
  49     java.base \
  50     java.datatransfer \
  51     java.desktop \
  52     java.instrument \
  53     java.logging \
  54     java.management \
  55     java.management.rmi \
  56     java.naming \
  57     java.prefs \
  58     java.rmi \
  59     java.security.sasl \
  60     java.xml \
  61     jdk.internal.vm.ci \
  62     jdk.jfr \
  63     jdk.management \
  64     jdk.management.jfr \
  65     jdk.management.agent \
  66     jdk.net \
  67     jdk.sctp \
  68     jdk.unsupported \
  69     #
  70 
  71 # to be deprivileged
  72 BOOT_MODULES += \
  73     jdk.naming.rmi \
  74     #
  75 
  76 # Modules that directly or indirectly requiring upgradeable modules
  77 # should carefully be considered if it should be upgradeable or not.
  78 UPGRADEABLE_MODULES += \
  79     java.compiler \
<a name="1" id="anc1"></a>
  80     jdk.internal.vm.compiler \
  81     jdk.internal.vm.compiler.management \
  82     #
  83 
  84 
  85 AGGREGATOR_MODULES += \
  86     java.se \
  87     #
  88 
  89 PLATFORM_MODULES += \
  90     $(UPGRADEABLE_MODULES) \
  91     $(AGGREGATOR_MODULES)
  92     #
  93 
  94 PLATFORM_MODULES += \
  95     java.net.http \
  96     java.scripting \
  97     java.security.jgss \
  98     java.smartcardio \
  99     java.sql \
 100     java.sql.rowset \
 101     java.transaction.xa \
 102     java.xml.crypto \
 103     jdk.accessibility \
 104     jdk.charsets \
 105     jdk.crypto.cryptoki \
 106     jdk.crypto.ec \
 107     jdk.dynalink \
 108     jdk.httpserver \
 109     jdk.jsobject \
 110     jdk.localedata \
 111     jdk.naming.dns \
 112     jdk.scripting.nashorn \
 113     jdk.security.auth \
 114     jdk.security.jgss \
 115     jdk.xml.dom \
 116     jdk.zipfs \
 117     #
 118 
 119 ifeq ($(OPENJDK_TARGET_OS), windows)
 120   PLATFORM_MODULES += jdk.crypto.mscapi
 121 endif
 122 
 123 ifeq ($(OPENJDK_TARGET_OS), solaris)
 124   PLATFORM_MODULES += jdk.crypto.ucrypto
 125 endif
 126 
 127 JRE_TOOL_MODULES += \
 128     jdk.jdwp.agent \
 129     jdk.pack \
 130     jdk.scripting.nashorn.shell \
 131     #
 132 
 133 ################################################################################
 134 
 135 # DOCS_MODULES defines the root modules for javadoc generation.
 136 # All of their `require transitive` modules directly and indirectly will be included.
 137 DOCS_MODULES += \
 138     java.se \
 139     java.smartcardio \
 140     jdk.accessibility \
 141     jdk.attach \
 142     jdk.charsets \
 143     jdk.compiler \
 144     jdk.crypto.cryptoki \
 145     jdk.crypto.ec \
 146     jdk.dynalink \
 147     jdk.editpad \
 148     jdk.hotspot.agent \
 149     jdk.httpserver \
 150     jdk.jartool \
 151     jdk.javadoc \
 152     jdk.jcmd \
 153     jdk.jconsole \
 154     jdk.jdeps \
 155     jdk.jdi \
 156     jdk.jdwp.agent \
 157     jdk.jfr \
 158     jdk.jlink \
 159     jdk.jsobject \
 160     jdk.jshell \
 161     jdk.jstatd \
 162     jdk.localedata \
 163     jdk.management \
 164     jdk.management.agent \
 165     jdk.management.jfr \
 166     jdk.naming.dns \
 167     jdk.naming.rmi \
 168     jdk.net \
 169     jdk.pack \
 170     jdk.rmic \
 171     jdk.scripting.nashorn \
 172     jdk.sctp \
 173     jdk.security.auth \
 174     jdk.security.jgss \
 175     jdk.xml.dom \
 176     jdk.zipfs \
 177     #
 178 
 179 # These modules are included in the interim image which is used to run profiling
 180 # before building the real images.
 181 INTERIM_IMAGE_MODULES := java.base java.logging
 182 
 183 LANGTOOLS_MODULES := \
 184     java.compiler \
 185     jdk.compiler \
 186     jdk.javadoc \
 187     jdk.jdeps \
 188     jdk.jshell \
 189     #
 190 
 191 HOTSPOT_MODULES := \
 192     jdk.aot \
 193     jdk.hotspot.agent \
 194     jdk.internal.vm.ci \
 195     jdk.internal.vm.compiler \
 196     jdk.internal.vm.compiler.management \
 197     #
 198 
 199 ################################################################################
 200 # Some platforms don't have the serviceability agent
 201 
 202 ifeq ($(INCLUDE_SA), false)
 203   MODULES_FILTER += jdk.hotspot.agent
 204 endif
 205 
 206 ################################################################################
 207 # Filter out Graal specific modules if Graal build is disabled
 208 
 209 ifeq ($(INCLUDE_GRAAL), false)
 210   MODULES_FILTER += jdk.internal.vm.compiler
 211   MODULES_FILTER += jdk.internal.vm.compiler.management
 212 endif
 213 
 214 ################################################################################
 215 # Filter out aot specific modules if aot is disabled
 216 
 217 ifeq ($(ENABLE_AOT), false)
 218   MODULES_FILTER += jdk.aot
 219 endif
 220 
 221 ################################################################################
 222 # Module list macros
 223 
 224 # Use append so that the custom extension may add to these variables
 225 
 226 GENERATED_SRC_DIRS += \
 227     $(SUPPORT_OUTPUTDIR)/gensrc \
 228     #
 229 
 230 TOP_SRC_DIRS += \
 231     $(TOPDIR)/src \
 232     #
 233 
 234 SRC_SUBDIRS += $(OPENJDK_TARGET_OS)/classes
 235 ifneq ($(OPENJDK_TARGET_OS), $(OPENJDK_TARGET_OS_TYPE))
 236   SRC_SUBDIRS += $(OPENJDK_TARGET_OS_TYPE)/classes
 237 endif
 238 SRC_SUBDIRS += share/classes
 239 
 240 SPEC_SUBDIRS += share/specs
 241 
 242 # Find all module-info.java files for the current build target platform and
 243 # configuration.
 244 # Param 1 - Module to find for, set to * for finding all
 245 FindAllModuleInfos = \
 246     $(sort $(wildcard \
 247         $(foreach sub, $(SRC_SUBDIRS), \
 248           $(patsubst %,%/$(strip $1)/$(sub)/module-info.java, $(TOP_SRC_DIRS))) \
 249         $(patsubst %,%/$(strip $1)/module-info.java, $(IMPORT_MODULES_SRC))))
 250 
 251 # Find module-info.java files in the specific source dir
 252 # Param 1 - Src dir to find module-info.java files in
 253 FindModuleInfosForSrcDir = \
 254     $(wildcard \
 255         $(foreach sub, $(SRC_SUBDIRS), \
 256           $(patsubst %,%/*/$(sub)/module-info.java, $(strip $1)) \
 257         ) \
 258         $(patsubst %,%/*/module-info.java, $(strip $1)) \
 259     )
 260 
 261 # Extract the module names from the paths of module-info.java files. The
 262 # position of the module directory differs depending on if this is an imported
 263 # src dir or not.
 264 GetModuleNameFromModuleInfo = \
 265     $(strip $(foreach mi, $1, \
 266       $(if $(filter $(addsuffix %, $(IMPORT_MODULES_SRC)), $(mi)), \
 267         $(notdir $(patsubst %/,%, $(dir $(mi)))), \
 268         $(notdir $(patsubst %/,%, $(dir $(patsubst %/,%, $(dir $(patsubst %/,%, $(dir $(mi)))))))))))
 269 
 270 # Find all modules by looking for module-info.java files and looking at parent
 271 # directories.
 272 FindAllModules = \
 273     $(sort $(filter-out $(MODULES_FILTER), \
 274     $(call GetModuleNameFromModuleInfo, $(MODULE_INFOS))))
 275 
 276 # Find all modules in a specific src dir
 277 # Param 1 - Src dir to find modules in
 278 FindModulesForSrcDir = \
 279     $(sort $(filter-out $(MODULES_FILTER), \
 280         $(call GetModuleNameFromModuleInfo, $(call FindModuleInfosForSrcDir, $1)) \
 281     ))
 282 
 283 FindImportedModules = \
 284     $(filter-out $(MODULES_FILTER), \
 285     $(if $(IMPORT_MODULES_CLASSES), $(notdir $(wildcard $(IMPORT_MODULES_CLASSES)/*))))
 286 
 287 # Find all source dirs for a particular module
 288 # $1 - Module to find source dirs for
 289 FindModuleSrcDirs = \
 290     $(strip $(wildcard \
 291         $(addsuffix /$(strip $1), $(GENERATED_SRC_DIRS) $(IMPORT_MODULES_SRC)) \
 292         $(foreach sub, $(SRC_SUBDIRS), $(addsuffix /$(strip $1)/$(sub), $(TOP_SRC_DIRS)))))
 293 
 294 # Find all specs dirs for a particular module
 295 # $1 - Module to find specs dirs for
 296 FindModuleSpecsDirs = \
 297     $(strip $(wildcard \
 298         $(foreach sub, $(SPEC_SUBDIRS), $(addsuffix /$(strip $1)/$(sub), $(TOP_SRC_DIRS)))))
 299 
 300 # Construct the complete module source path
 301 GetModuleSrcPath = \
 302     $(call PathList, \
 303         $(addsuffix /*, $(GENERATED_SRC_DIRS) $(IMPORT_MODULES_SRC)) \
 304         $(foreach sub, $(SRC_SUBDIRS), $(addsuffix /*/$(sub), $(TOP_SRC_DIRS))))
 305 
 306 ################################################################################
 307 # Extract module dependencies from module-info.java files, both normal
 308 # dependencies ("requires"), and indirect exports ("requires transitive").
 309 
 310 MODULE_DEPS_MAKEFILE := $(MAKESUPPORT_OUTPUTDIR)/module-deps.gmk
 311 
 312 MODULE_INFOS := $(call FindAllModuleInfos, *)
 313 
 314 $(MODULE_DEPS_MAKEFILE): $(MODULE_INFOS) \
 315     $(call DependOnVariable, MODULE_INFOS, $(MAKESUPPORT_OUTPUTDIR)/MODULE_INFOS.vardeps)
 316         $(MKDIR) -p $(@D)
 317         $(RM) $@
 318         $(foreach m, $(MODULE_INFOS), \
 319             ( $(PRINTF) "DEPS_$(call GetModuleNameFromModuleInfo, $m) :=" &amp;&amp; \
 320               $(NAWK) -v MODULE=$(call GetModuleNameFromModuleInfo, $m) '\
 321                   BEGIN      { if (MODULE != "java.base") printf(" java.base"); } \
 322                   /^ *requires/ { sub(/;/, ""); \
 323                                   sub(/requires /, " "); \
 324                                   sub(/ static /, " "); \
 325                                   sub(/ transitive /, " "); \
 326                                   sub(/\/\/.*/, ""); \
 327                                   sub(/\/\*.*\*\//, ""); \
 328                                   gsub(/^ +\*.*/, ""); \
 329                                   gsub(/ /, ""); \
 330                                   printf(" %s", $$0) } \
 331                   END           { printf("\n") }' $m &amp;&amp; \
 332               $(PRINTF) "TRANSITIVE_MODULES_$(call GetModuleNameFromModuleInfo, $m) :=" &amp;&amp; \
 333               $(NAWK) -v MODULE=$(call GetModuleNameFromModuleInfo, $m) '\
 334                   BEGIN      { if (MODULE != "java.base") printf(" java.base"); } \
 335                   /^ *requires  *transitive/ { \
 336                                   sub(/;/, ""); \
 337                                   sub(/requires/, ""); \
 338                                   sub(/transitive/, ""); \
 339                                   sub(/\/\/.*/, ""); \
 340                                   sub(/\/\*.*\*\//, ""); \
 341                                   gsub(/^ +\*.*/, ""); \
 342                                   gsub(/ /, ""); \
 343                                   printf(" %s", $$0) } \
 344                   END           { printf("\n") }' $m \
 345             ) &gt;&gt; $@ $(NEWLINE))
 346 
 347 -include $(MODULE_DEPS_MAKEFILE)
 348 
 349 # Find dependencies ("requires") for a given module.
 350 # Param 1: Module to find dependencies for.
 351 FindDepsForModule = \
 352   $(DEPS_$(strip $1))
 353 
 354 # Find dependencies ("requires") transitively in 3 levels for a given module.
 355 # Param 1: Module to find dependencies for.
 356 FindTransitiveDepsForModule = \
 357     $(sort $(call FindDepsForModule, $1) \
 358         $(foreach m, $(call FindDepsForModule, $1), \
 359             $(call FindDepsForModule, $m) \
 360             $(foreach n, $(call FindDepsForModule, $m), \
 361                  $(call FindDepsForModule, $n))))
 362 
 363 # Find dependencies ("requires") transitively in 3 levels for a set of modules.
 364 # Param 1: List of modules to find dependencies for.
 365 FindTransitiveDepsForModules = \
 366     $(sort $(foreach m, $1, $(call FindTransitiveDepsForModule, $m)))
 367 
 368 # Find indirect exported modules ("requires transitive") for a given module .
 369 # Param 1: Module to find indirect exported modules for.
 370 FindIndirectExportsForModule = \
 371   $(TRANSITIVE_MODULES_$(strip $1))
 372 
 373 # Finds indirect exported modules transitively in 3 levels for a given module.
 374 # Param 1: Module to find indirect exported modules for.
 375 FindTransitiveIndirectDepsForModule = \
 376     $(sort $(call FindIndirectExportsForModule, $1) \
 377         $(foreach m, $(call FindIndirectExportsForModule, $1), \
 378             $(call FindIndirectExportsForModule, $m) \
 379             $(foreach n, $(call FindIndirectExportsForModule, $m), \
 380                  $(call FindIndirectExportsForModule, $n))))
 381 
 382 # Finds indirect exported modules transitively in 3 levels for a set of modules.
 383 # Param 1: List of modules to find indirect exported modules for.
 384 FindTransitiveIndirectDepsForModules = \
 385     $(sort $(foreach m, $1, $(call FindTransitiveIndirectDepsForModule, $m)))
 386 
 387 # Upgradeable modules are those that are either defined as upgradeable or that
 388 # require an upradeable module.
 389 FindAllUpgradeableModules = \
 390     $(sort $(filter-out $(MODULES_FILTER), $(UPGRADEABLE_MODULES)))
 391 
 392 
 393 ################################################################################
 394 
 395 LEGAL_SUBDIRS += $(OPENJDK_TARGET_OS)/legal
 396 ifneq ($(OPENJDK_TARGET_OS), $(OPENJDK_TARGET_OS_TYPE))
 397   LEGAL_SUBDIRS += $(OPENJDK_TARGET_OS_TYPE)/legal
 398 endif
 399 LEGAL_SUBDIRS += share/legal
 400 
 401 # Find all legal src dirs for a particular module
 402 # $1 - Module to find legal dirs for
 403 FindModuleLegalSrcDirs = \
 404     $(strip $(wildcard \
 405         $(addsuffix /$(strip $1), $(IMPORT_MODULES_LEGAL)) \
 406         $(foreach sub, $(LEGAL_SUBDIRS), $(addsuffix /$(strip $1)/$(sub), $(TOP_SRC_DIRS))) \
 407     ))
 408 
 409 ################################################################################
 410 
 411 # Param 1 - Name of module
 412 define ReadSingleImportMetaData
 413     ifneq ($$(wildcard $(IMPORT_MODULES_MAKE)/$$(strip $1)/build.properties), )
 414       classloader :=
 415       include_in_jre :=
 416       include_in_jdk :=
 417       include $(IMPORT_MODULES_MAKE)/$$(strip $1)/build.properties
 418       ifeq ($$(include_in_jre), true)
 419         JRE_MODULES += $1
 420       endif
 421       ifeq ($$(include_in_jdk), true)
 422         JDK_MODULES += $1
 423       endif
 424       ifeq ($$(classloader), boot)
 425         BOOT_MODULES += $1
 426       else ifeq ($$(classloader), ext)
 427         PLATFORM_MODULES += $1
 428       endif
 429       ifneq ($$(include_in_docs), false)
 430         # defaults to true if unspecified
 431         DOCS_MODULES += $1
 432       endif
 433     else
 434       # Default to include in all
 435       JRE_MODULES += $1
 436       JDK_MODULES += $1
 437     endif
 438 endef
 439 
 440 # Reading the imported modules metadata has a cost, so to make it available,
 441 # a makefile needs to eval-call this macro first. After calling this, the
 442 # following variables are populated with data from the imported modules:
 443 # * JRE_MODULES
 444 # * JDK_MODULES
 445 # * BOOT_MODULES
 446 # * PLATFORM_MODULES
 447 # * JRE_TOOL_MODULES
 448 define ReadImportMetaData
 449     IMPORTED_MODULES := $$(call FindImportedModules)
 450     $$(foreach m, $$(IMPORTED_MODULES), \
 451       $$(eval $$(call ReadSingleImportMetaData, $$m)))
 452 endef
 453 
 454 ################################################################################
 455 
 456 endif # _MODULES_GMK
<a name="2" id="anc2"></a><b style="font-size: large; color: red">--- EOF ---</b>















































































</pre><form name="eof"><input name="value" value="2" type="hidden" /></form></body></html>
