<?xml version="1.0"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head><meta charset="utf-8">
<meta http-equiv="cache-control" content="no-cache" />
<meta http-equiv="Pragma" content="no-cache" />
<meta http-equiv="Expires" content="-1" />
<!--
   Note to customizers: the body of the webrev is IDed as SUNWwebrev
   to allow easy overriding by users of webrev via the userContent.css
   mechanism available in some browsers.

   For example, to have all "removed" information be red instead of
   brown, set a rule in your userContent.css file like:

       body#SUNWwebrev span.removed { color: red ! important; }
-->
<style type="text/css" media="screen">
body {
    background-color: #eeeeee;
}
hr {
    border: none 0;
    border-top: 1px solid #aaa;
    height: 1px;
}
div.summary {
    font-size: .8em;
    border-bottom: 1px solid #aaa;
    padding-left: 1em;
    padding-right: 1em;
}
div.summary h2 {
    margin-bottom: 0.3em;
}
div.summary table th {
    text-align: right;
    vertical-align: top;
    white-space: nowrap;
}
span.lineschanged {
    font-size: 0.7em;
}
span.oldmarker {
    color: red;
    font-size: large;
    font-weight: bold;
}
span.newmarker {
    color: green;
    font-size: large;
    font-weight: bold;
}
span.removed {
    color: brown;
}
span.changed {
    color: blue;
}
span.new {
    color: blue;
    font-weight: bold;
}
a.print { font-size: x-small; }

</style>

<style type="text/css" media="print">
pre { font-size: 0.8em; font-family: courier, monospace; }
span.removed { color: #444; font-style: italic }
span.changed { font-weight: bold; }
span.new { font-weight: bold; }
span.newmarker { font-size: 1.2em; font-weight: bold; }
span.oldmarker { font-size: 1.2em; font-weight: bold; }
a.print {display: none}
hr { border: none 0; border-top: 1px solid #aaa; height: 1px; }
</style>

<title>Old src/hotspot/share/jvmci/vmStructs_jvmci.cpp</title>
<body id="SUNWwebrev">
<pre>
   1 /*
   2  * Copyright (c) 2015, 2018, Oracle and/or its affiliates. All rights reserved.
   3  * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
   4  *
   5  * This code is free software; you can redistribute it and/or modify it
   6  * under the terms of the GNU General Public License version 2 only, as
   7  * published by the Free Software Foundation.
   8  *
   9  * This code is distributed in the hope that it will be useful, but WITHOUT
  10  * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
  11  * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License
  12  * version 2 for more details (a copy is included in the LICENSE file that
  13  * accompanied this code).
  14  *
  15  * You should have received a copy of the GNU General Public License version
  16  * 2 along with this work; if not, write to the Free Software Foundation,
  17  * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.
  18  *
  19  * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA
  20  * or visit www.oracle.com if you need additional information or have any
  21  * questions.
  22  *
  23  */
  24 
  25 #include "precompiled.hpp"
  26 #include "code/codeBlob.hpp"
  27 #include "compiler/abstractCompiler.hpp"
  28 #include "compiler/compileBroker.hpp"
  29 #include "gc/shared/collectedHeap.hpp"
  30 #include "jvmci/jvmciCodeInstaller.hpp"
  31 #include "jvmci/jvmciCompilerToVM.hpp"
  32 #include "jvmci/jvmciEnv.hpp"
  33 #include "jvmci/jvmciRuntime.hpp"
  34 #include "jvmci/vmStructs_compiler_runtime.hpp"
  35 #include "jvmci/vmStructs_jvmci.hpp"
  36 #include "oops/oop.hpp"
  37 #include "oops/oopHandle.hpp"
  38 #include "oops/objArrayKlass.hpp"
  39 #include "runtime/flags/jvmFlag.hpp"
  40 #include "runtime/globals.hpp"
  41 #include "runtime/sharedRuntime.hpp"
  42 #include "runtime/thread.hpp"
  43 #include "runtime/vm_version.hpp"
  44 #if INCLUDE_G1GC
  45 #include "gc/g1/g1BarrierSet.hpp"
  46 #include "gc/g1/g1CardTable.hpp"
  47 #include "gc/g1/heapRegion.hpp"
  48 #include "gc/g1/g1ThreadLocalData.hpp"
  49 #endif
  50 
  51 #define VM_STRUCTS(nonstatic_field, static_field, unchecked_nonstatic_field, volatile_nonstatic_field) \
  52   static_field(CompilerToVM::Data,             Klass_vtable_start_offset,              int)                                          \
  53   static_field(CompilerToVM::Data,             Klass_vtable_length_offset,             int)                                          \
  54                                                                                                                                      \
  55   static_field(CompilerToVM::Data,             Method_extra_stack_entries,             int)                                          \
  56                                                                                                                                      \
  57   static_field(CompilerToVM::Data,             SharedRuntime_ic_miss_stub,             address)                                      \
  58   static_field(CompilerToVM::Data,             SharedRuntime_handle_wrong_method_stub, address)                                      \
  59   static_field(CompilerToVM::Data,             SharedRuntime_deopt_blob_unpack,        address)                                      \
  60   static_field(CompilerToVM::Data,             SharedRuntime_deopt_blob_uncommon_trap, address)                                      \
  61                                                                                                                                      \
  62   static_field(CompilerToVM::Data,             ThreadLocalAllocBuffer_alignment_reserve, size_t)                                     \
  63                                                                                                                                      \
  64   static_field(CompilerToVM::Data,             Universe_collectedHeap,                 CollectedHeap*)                               \
  65   static_field(CompilerToVM::Data,             Universe_base_vtable_size,              int)                                          \
  66   static_field(CompilerToVM::Data,             Universe_narrow_oop_base,               address)                                      \
  67   static_field(CompilerToVM::Data,             Universe_narrow_oop_shift,              int)                                          \
  68   static_field(CompilerToVM::Data,             Universe_narrow_klass_base,             address)                                      \
  69   static_field(CompilerToVM::Data,             Universe_narrow_klass_shift,            int)                                          \
  70   static_field(CompilerToVM::Data,             Universe_non_oop_bits,                  void*)                                        \
  71   static_field(CompilerToVM::Data,             Universe_verify_oop_mask,               uintptr_t)                                    \
  72   static_field(CompilerToVM::Data,             Universe_verify_oop_bits,               uintptr_t)                                    \
  73                                                                                                                                      \
  74   static_field(CompilerToVM::Data,             _supports_inline_contig_alloc,          bool)                                         \
  75   static_field(CompilerToVM::Data,             _heap_end_addr,                         HeapWord**)                                   \
  76   static_field(CompilerToVM::Data,             _heap_top_addr,                         HeapWord* volatile*)                          \
  77                                                                                                                                      \
  78   static_field(CompilerToVM::Data,             _max_oop_map_stack_offset,              int)                                          \
  79                                                                                                                                      \
  80   static_field(CompilerToVM::Data,             cardtable_start_address,                jbyte*)                                       \
  81   static_field(CompilerToVM::Data,             cardtable_shift,                        int)                                          \
  82                                                                                                                                      \
  83   static_field(CompilerToVM::Data,             vm_page_size,                           int)                                          \
  84                                                                                                                                      \
  85   static_field(CompilerToVM::Data,             sizeof_vtableEntry,                     int)                                          \
  86   static_field(CompilerToVM::Data,             sizeof_ExceptionTableElement,           int)                                          \
  87   static_field(CompilerToVM::Data,             sizeof_LocalVariableTableElement,       int)                                          \
  88   static_field(CompilerToVM::Data,             sizeof_ConstantPool,                    int)                                          \
  89   static_field(CompilerToVM::Data,             sizeof_SymbolPointer,                   int)                                          \
  90   static_field(CompilerToVM::Data,             sizeof_narrowKlass,                     int)                                          \
  91   static_field(CompilerToVM::Data,             sizeof_arrayOopDesc,                    int)                                          \
  92   static_field(CompilerToVM::Data,             sizeof_BasicLock,                       int)                                          \
  93                                                                                                                                      \
  94   static_field(CompilerToVM::Data,             dsin,                                   address)                                      \
  95   static_field(CompilerToVM::Data,             dcos,                                   address)                                      \
  96   static_field(CompilerToVM::Data,             dtan,                                   address)                                      \
  97   static_field(CompilerToVM::Data,             dexp,                                   address)                                      \
  98   static_field(CompilerToVM::Data,             dlog,                                   address)                                      \
  99   static_field(CompilerToVM::Data,             dlog10,                                 address)                                      \
 100   static_field(CompilerToVM::Data,             dpow,                                   address)                                      \
 101                                                                                                                                      \
 102   static_field(CompilerToVM::Data,             symbol_init,                            address)                                      \
 103   static_field(CompilerToVM::Data,             symbol_clinit,                          address)                                      \
 104                                                                                                                                      \
 105   static_field(Abstract_VM_Version,            _features,                              uint64_t)                                     \
 106                                                                                                                                      \
 107   nonstatic_field(Array&lt;int&gt;,                  _length,                                int)                                          \
 108   unchecked_nonstatic_field(Array&lt;u1&gt;,         _data,                                  sizeof(u1))                                   \
 109   unchecked_nonstatic_field(Array&lt;u2&gt;,         _data,                                  sizeof(u2))                                   \
 110   nonstatic_field(Array&lt;Klass*&gt;,               _length,                                int)                                          \
 111   nonstatic_field(Array&lt;Klass*&gt;,               _data[0],                               Klass*)                                       \
 112                                                                                                                                      \
 113   volatile_nonstatic_field(BasicLock,          _displaced_header,                      markOop)                                      \
 114                                                                                                                                      \
 115   static_field(CodeCache,                      _low_bound,                             address)                                      \
 116   static_field(CodeCache,                      _high_bound,                            address)                                      \
 117                                                                                                                                      \
 118   nonstatic_field(CollectedHeap,               _total_collections,                     unsigned int)                                 \
 119                                                                                                                                      \
 120   nonstatic_field(CompileTask,                 _num_inlined_bytecodes,                 int)                                          \
 121                                                                                                                                      \
 122   nonstatic_field(ConstantPool,                _tags,                                  Array&lt;u1&gt;*)                                   \
 123   nonstatic_field(ConstantPool,                _pool_holder,                           InstanceKlass*)                               \
 124   nonstatic_field(ConstantPool,                _length,                                int)                                          \
 125   nonstatic_field(ConstantPool,                _flags,                                 int)                                          \
 126                                                                                                                                      \
 127   nonstatic_field(ConstMethod,                 _constants,                             ConstantPool*)                                \
 128   nonstatic_field(ConstMethod,                 _flags,                                 u2)                                           \
 129   nonstatic_field(ConstMethod,                 _code_size,                             u2)                                           \
 130   nonstatic_field(ConstMethod,                 _name_index,                            u2)                                           \
 131   nonstatic_field(ConstMethod,                 _signature_index,                       u2)                                           \
 132   nonstatic_field(ConstMethod,                 _method_idnum,                          u2)                                           \
 133   nonstatic_field(ConstMethod,                 _max_stack,                             u2)                                           \
 134   nonstatic_field(ConstMethod,                 _max_locals,                            u2)                                           \
 135                                                                                                                                      \
 136   nonstatic_field(DataLayout,                  _header._struct._tag,                   u1)                                           \
 137   nonstatic_field(DataLayout,                  _header._struct._flags,                 u1)                                           \
 138   nonstatic_field(DataLayout,                  _header._struct._bci,                   u2)                                           \
 139   nonstatic_field(DataLayout,                  _header._struct._traps,                 u4)                                           \
 140   nonstatic_field(DataLayout,                  _cells[0],                              intptr_t)                                     \
 141                                                                                                                                      \
 142   nonstatic_field(Deoptimization::UnrollBlock, _size_of_deoptimized_frame,             int)                                          \
 143   nonstatic_field(Deoptimization::UnrollBlock, _caller_adjustment,                     int)                                          \
 144   nonstatic_field(Deoptimization::UnrollBlock, _number_of_frames,                      int)                                          \
 145   nonstatic_field(Deoptimization::UnrollBlock, _total_frame_sizes,                     int)                                          \
 146   nonstatic_field(Deoptimization::UnrollBlock, _frame_sizes,                           intptr_t*)                                    \
 147   nonstatic_field(Deoptimization::UnrollBlock, _frame_pcs,                             address*)                                     \
 148   nonstatic_field(Deoptimization::UnrollBlock, _initial_info,                          intptr_t)                                     \
 149   nonstatic_field(Deoptimization::UnrollBlock, _unpack_kind,                           int)                                          \
 150                                                                                                                                      \
 151   nonstatic_field(ExceptionTableElement,       start_pc,                                      u2)                                    \
 152   nonstatic_field(ExceptionTableElement,       end_pc,                                        u2)                                    \
 153   nonstatic_field(ExceptionTableElement,       handler_pc,                                    u2)                                    \
 154   nonstatic_field(ExceptionTableElement,       catch_type_index,                              u2)                                    \
 155                                                                                                                                      \
 156   nonstatic_field(JVMFlag,                     _type,                                         const char*)                           \
 157   nonstatic_field(JVMFlag,                     _name,                                         const char*)                           \
 158   unchecked_nonstatic_field(JVMFlag,           _addr,                                         sizeof(void*))                         \
 159   nonstatic_field(JVMFlag,                     _flags,                                        JVMFlag::Flags)                        \
 160   static_field(JVMFlag,                        flags,                                         JVMFlag*)                              \
 161                                                                                                                                      \
 162   nonstatic_field(InstanceKlass,               _fields,                                       Array&lt;u2&gt;*)                            \
 163   nonstatic_field(InstanceKlass,               _constants,                                    ConstantPool*)                         \
 164   nonstatic_field(InstanceKlass,               _source_file_name_index,                       u2)                                    \
 165   nonstatic_field(InstanceKlass,               _init_state,                                   u1)                                    \
 166   nonstatic_field(InstanceKlass,               _misc_flags,                                   u2)                                    \
 167                                                                                                                                      \
 168   volatile_nonstatic_field(JavaFrameAnchor,    _last_Java_sp,                                 intptr_t*)                             \
 169   volatile_nonstatic_field(JavaFrameAnchor,    _last_Java_pc,                                 address)                               \
 170                                                                                                                                      \
 171   nonstatic_field(JavaThread,                  _threadObj,                                    oop)                                   \
 172   nonstatic_field(JavaThread,                  _anchor,                                       JavaFrameAnchor)                       \
 173   nonstatic_field(JavaThread,                  _vm_result,                                    oop)                                   \
 174   volatile_nonstatic_field(JavaThread,         _exception_oop,                                oop)                                   \
 175   volatile_nonstatic_field(JavaThread,         _exception_pc,                                 address)                               \
 176   volatile_nonstatic_field(JavaThread,         _is_method_handle_return,                      int)                                   \
 177   nonstatic_field(JavaThread,                  _osthread,                                     OSThread*)                             \
 178   nonstatic_field(JavaThread,                  _pending_deoptimization,                       int)                                   \
 179   nonstatic_field(JavaThread,                  _pending_failed_speculation,                   long)                                  \
 180   nonstatic_field(JavaThread,                  _pending_transfer_to_interpreter,              bool)                                  \
 181   nonstatic_field(JavaThread,                  _jvmci_counters,                               jlong*)                                \
 182   nonstatic_field(JavaThread,                  _reserved_stack_activation,                    address)                               \
 183                                                                                                                                      \
 184   static_field(java_lang_Class,                _klass_offset,                                 int)                                   \
 185   static_field(java_lang_Class,                _array_klass_offset,                           int)                                   \
 186                                                                                                                                      \
 187   nonstatic_field(JVMCIEnv,                    _task,                                         CompileTask*)                          \
 188   nonstatic_field(JVMCIEnv,                    _jvmti_can_hotswap_or_post_breakpoint,         bool)                                  \
 189                                                                                                                                      \
 190   nonstatic_field(InvocationCounter,           _counter,                                      unsigned int)                          \
 191                                                                                                                                      \
 192   nonstatic_field(Klass,                       _secondary_super_cache,                        Klass*)                                \
 193   nonstatic_field(Klass,                       _secondary_supers,                             Array&lt;Klass*&gt;*)                        \
 194   nonstatic_field(Klass,                       _super,                                        Klass*)                                \
 195   nonstatic_field(Klass,                       _super_check_offset,                           juint)                                 \
 196   nonstatic_field(Klass,                       _subklass,                                     Klass*)                                \
 197   nonstatic_field(Klass,                       _layout_helper,                                jint)                                  \
 198   nonstatic_field(Klass,                       _name,                                         Symbol*)                               \
 199   nonstatic_field(Klass,                       _prototype_header,                             markOop)                               \
 200   nonstatic_field(Klass,                       _next_sibling,                                 Klass*)                                \
 201   nonstatic_field(Klass,                       _java_mirror,                                  OopHandle)                             \
 202   nonstatic_field(Klass,                       _modifier_flags,                               jint)                                  \
 203   nonstatic_field(Klass,                       _access_flags,                                 AccessFlags)                           \
 204                                                                                                                                      \
 205   nonstatic_field(LocalVariableTableElement,   start_bci,                                     u2)                                    \
 206   nonstatic_field(LocalVariableTableElement,   length,                                        u2)                                    \
 207   nonstatic_field(LocalVariableTableElement,   name_cp_index,                                 u2)                                    \
 208   nonstatic_field(LocalVariableTableElement,   descriptor_cp_index,                           u2)                                    \
 209   nonstatic_field(LocalVariableTableElement,   signature_cp_index,                            u2)                                    \
 210   nonstatic_field(LocalVariableTableElement,   slot,                                          u2)                                    \
 211                                                                                                                                      \
 212   nonstatic_field(Method,                      _constMethod,                                  ConstMethod*)                          \
 213   nonstatic_field(Method,                      _method_data,                                  MethodData*)                           \
 214   nonstatic_field(Method,                      _method_counters,                              MethodCounters*)                       \
 215   nonstatic_field(Method,                      _access_flags,                                 AccessFlags)                           \
 216   nonstatic_field(Method,                      _vtable_index,                                 int)                                   \
 217   nonstatic_field(Method,                      _intrinsic_id,                                 u2)                                    \
 218   nonstatic_field(Method,                      _flags,                                        u2)                                    \
 219   volatile_nonstatic_field(Method,             _code,                                         CompiledMethod*)                       \
 220   volatile_nonstatic_field(Method,             _from_compiled_entry,                          address)                               \
 221                                                                                                                                      \
 222   nonstatic_field(MethodCounters,              _nmethod_age,                                  int)                                   \
 223   nonstatic_field(MethodCounters,              _interpreter_invocation_limit,                 int)                                   \
 224   nonstatic_field(MethodCounters,              _interpreter_backward_branch_limit,            int)                                   \
 225   nonstatic_field(MethodCounters,              _interpreter_profile_limit,                    int)                                   \
 226   nonstatic_field(MethodCounters,              _invoke_mask,                                  int)                                   \
 227   nonstatic_field(MethodCounters,              _backedge_mask,                                int)                                   \
 228   nonstatic_field(MethodCounters,              _interpreter_invocation_count,                 int)                                   \
 229   nonstatic_field(MethodCounters,              _interpreter_throwout_count,                   u2)                                    \
 230   JVMTI_ONLY(nonstatic_field(MethodCounters,   _number_of_breakpoints,                        u2))                                   \
 231   nonstatic_field(MethodCounters,              _invocation_counter,                           InvocationCounter)                     \
 232   nonstatic_field(MethodCounters,              _backedge_counter,                             InvocationCounter)                     \
 233                                                                                                                                      \
 234   nonstatic_field(MethodData,                  _size,                                         int)                                   \
 235   nonstatic_field(MethodData,                  _method,                                       Method*)                               \
 236   nonstatic_field(MethodData,                  _data_size,                                    int)                                   \
 237   nonstatic_field(MethodData,                  _data[0],                                      intptr_t)                              \
 238   nonstatic_field(MethodData,                  _parameters_type_data_di,                      int)                                   \
 239   nonstatic_field(MethodData,                  _nof_decompiles,                               uint)                                  \
 240   nonstatic_field(MethodData,                  _nof_overflow_recompiles,                      uint)                                  \
 241   nonstatic_field(MethodData,                  _nof_overflow_traps,                           uint)                                  \
 242   nonstatic_field(MethodData,                  _trap_hist._array[0],                          u1)                                    \
 243   nonstatic_field(MethodData,                  _eflags,                                       intx)                                  \
 244   nonstatic_field(MethodData,                  _arg_local,                                    intx)                                  \
 245   nonstatic_field(MethodData,                  _arg_stack,                                    intx)                                  \
 246   nonstatic_field(MethodData,                  _arg_returned,                                 intx)                                  \
 247   nonstatic_field(MethodData,                  _tenure_traps,                                 uint)                                  \
 248   nonstatic_field(MethodData,                  _invoke_mask,                                  int)                                   \
 249   nonstatic_field(MethodData,                  _backedge_mask,                                int)                                   \
 250   nonstatic_field(MethodData,                  _jvmci_ir_size,                                int)                                   \
 251                                                                                                                                      \
 252   nonstatic_field(nmethod,                     _verified_entry_point,                         address)                               \
 253   nonstatic_field(nmethod,                     _comp_level,                                   int)                                   \
 254                                                                                                                                      \
 255   nonstatic_field(ObjArrayKlass,               _element_klass,                                Klass*)                                \
 256                                                                                                                                      \
 257   volatile_nonstatic_field(oopDesc,            _mark,                                         markOop)                               \
 258   volatile_nonstatic_field(oopDesc,            _metadata._klass,                              Klass*)                                \
 259                                                                                                                                      \
 260   static_field(os,                             _polling_page,                                 address)                               \
 261                                                                                                                                      \
 262   volatile_nonstatic_field(OSThread,           _interrupted,                                  jint)                                  \
 263                                                                                                                                      \
 264   static_field(StubRoutines,                _verify_oop_count,                                jint)                                  \
 265                                                                                                                                      \
 266   static_field(StubRoutines,                _throw_delayed_StackOverflowError_entry,          address)                               \
 267                                                                                                                                      \
 268   static_field(StubRoutines,                _jbyte_arraycopy,                                 address)                               \
 269   static_field(StubRoutines,                _jshort_arraycopy,                                address)                               \
 270   static_field(StubRoutines,                _jint_arraycopy,                                  address)                               \
 271   static_field(StubRoutines,                _jlong_arraycopy,                                 address)                               \
 272   static_field(StubRoutines,                _oop_arraycopy,                                   address)                               \
 273   static_field(StubRoutines,                _oop_arraycopy_uninit,                            address)                               \
 274   static_field(StubRoutines,                _jbyte_disjoint_arraycopy,                        address)                               \
 275   static_field(StubRoutines,                _jshort_disjoint_arraycopy,                       address)                               \
 276   static_field(StubRoutines,                _jint_disjoint_arraycopy,                         address)                               \
 277   static_field(StubRoutines,                _jlong_disjoint_arraycopy,                        address)                               \
 278   static_field(StubRoutines,                _oop_disjoint_arraycopy,                          address)                               \
 279   static_field(StubRoutines,                _oop_disjoint_arraycopy_uninit,                   address)                               \
 280   static_field(StubRoutines,                _arrayof_jbyte_arraycopy,                         address)                               \
 281   static_field(StubRoutines,                _arrayof_jshort_arraycopy,                        address)                               \
 282   static_field(StubRoutines,                _arrayof_jint_arraycopy,                          address)                               \
 283   static_field(StubRoutines,                _arrayof_jlong_arraycopy,                         address)                               \
 284   static_field(StubRoutines,                _arrayof_oop_arraycopy,                           address)                               \
 285   static_field(StubRoutines,                _arrayof_oop_arraycopy_uninit,                    address)                               \
 286   static_field(StubRoutines,                _arrayof_jbyte_disjoint_arraycopy,                address)                               \
 287   static_field(StubRoutines,                _arrayof_jshort_disjoint_arraycopy,               address)                               \
 288   static_field(StubRoutines,                _arrayof_jint_disjoint_arraycopy,                 address)                               \
 289   static_field(StubRoutines,                _arrayof_jlong_disjoint_arraycopy,                address)                               \
 290   static_field(StubRoutines,                _arrayof_oop_disjoint_arraycopy,                  address)                               \
 291   static_field(StubRoutines,                _arrayof_oop_disjoint_arraycopy_uninit,           address)                               \
 292   static_field(StubRoutines,                _checkcast_arraycopy,                             address)                               \
 293   static_field(StubRoutines,                _checkcast_arraycopy_uninit,                      address)                               \
 294   static_field(StubRoutines,                _unsafe_arraycopy,                                address)                               \
 295   static_field(StubRoutines,                _generic_arraycopy,                               address)                               \
 296                                                                                                                                      \
 297   static_field(StubRoutines,                _aescrypt_encryptBlock,                           address)                               \
 298   static_field(StubRoutines,                _aescrypt_decryptBlock,                           address)                               \
 299   static_field(StubRoutines,                _cipherBlockChaining_encryptAESCrypt,             address)                               \
 300   static_field(StubRoutines,                _cipherBlockChaining_decryptAESCrypt,             address)                               \
 301   static_field(StubRoutines,                _counterMode_AESCrypt,                            address)                               \
 302   static_field(StubRoutines,                _base64_encodeBlock,                              address)                               \
 303   static_field(StubRoutines,                _ghash_processBlocks,                             address)                               \
 304   static_field(StubRoutines,                _sha1_implCompress,                               address)                               \
 305   static_field(StubRoutines,                _sha1_implCompressMB,                             address)                               \
 306   static_field(StubRoutines,                _sha256_implCompress,                             address)                               \
 307   static_field(StubRoutines,                _sha256_implCompressMB,                           address)                               \
 308   static_field(StubRoutines,                _sha512_implCompress,                             address)                               \
 309   static_field(StubRoutines,                _sha512_implCompressMB,                           address)                               \
 310   static_field(StubRoutines,                _updateBytesCRC32,                                address)                               \
 311   static_field(StubRoutines,                _crc_table_adr,                                   address)                               \
 312   static_field(StubRoutines,                _crc32c_table_addr,                               address)                               \
 313   static_field(StubRoutines,                _updateBytesCRC32C,                               address)                               \
 314   static_field(StubRoutines,                _updateBytesAdler32,                              address)                               \
 315   static_field(StubRoutines,                _multiplyToLen,                                   address)                               \
 316   static_field(StubRoutines,                _squareToLen,                                     address)                               \
 317   static_field(StubRoutines,                _mulAdd,                                          address)                               \
 318   static_field(StubRoutines,                _montgomeryMultiply,                              address)                               \
 319   static_field(StubRoutines,                _montgomerySquare,                                address)                               \
 320   static_field(StubRoutines,                _vectorizedMismatch,                              address)                               \
 321                                                                                                                                      \
 322   nonstatic_field(Thread,                   _tlab,                                            ThreadLocalAllocBuffer)                \
 323   nonstatic_field(Thread,                   _allocated_bytes,                                 jlong)                                 \
 324   nonstatic_field(Thread,                   _polling_page,                                    address)                               \
 325                                                                                                                                      \
 326   nonstatic_field(ThreadLocalAllocBuffer,   _start,                                           HeapWord*)                             \
 327   nonstatic_field(ThreadLocalAllocBuffer,   _top,                                             HeapWord*)                             \
 328   nonstatic_field(ThreadLocalAllocBuffer,   _end,                                             HeapWord*)                             \
 329   nonstatic_field(ThreadLocalAllocBuffer,   _pf_top,                                          HeapWord*)                             \
 330   nonstatic_field(ThreadLocalAllocBuffer,   _desired_size,                                    size_t)                                \
 331   nonstatic_field(ThreadLocalAllocBuffer,   _refill_waste_limit,                              size_t)                                \
 332   nonstatic_field(ThreadLocalAllocBuffer,   _number_of_refills,                               unsigned)                              \
 333   nonstatic_field(ThreadLocalAllocBuffer,   _fast_refill_waste,                               unsigned)                              \
 334   nonstatic_field(ThreadLocalAllocBuffer,   _slow_allocations,                                unsigned)                              \
 335                                                                                                                                      \
 336   nonstatic_field(ThreadShadow,             _pending_exception,                               oop)                                   \
 337                                                                                                                                      \
 338   static_field(vmSymbols,                   _symbols[0],                                      Symbol*)                               \
 339                                                                                                                                      \
 340   nonstatic_field(vtableEntry,              _method,                                          Method*)                               \
 341 
 342 #define VM_TYPES(declare_type, declare_toplevel_type, declare_integer_type, declare_unsigned_integer_type) \
 343   declare_integer_type(bool)                                              \
 344   declare_unsigned_integer_type(size_t)                                   \
 345   declare_integer_type(intx)                                              \
 346   declare_unsigned_integer_type(uintx)                                    \
 347                                                                           \
 348   declare_toplevel_type(BasicLock)                                        \
 349   declare_toplevel_type(CompilerToVM)                                     \
 350   declare_toplevel_type(ExceptionTableElement)                            \
 351   declare_toplevel_type(JVMFlag)                                          \
 352   declare_toplevel_type(JVMFlag*)                                         \
 353   declare_toplevel_type(InvocationCounter)                                \
 354   declare_toplevel_type(JVMCIEnv)                                         \
 355   declare_toplevel_type(LocalVariableTableElement)                        \
 356   declare_toplevel_type(narrowKlass)                                      \
 357   declare_toplevel_type(Symbol*)                                          \
 358   declare_toplevel_type(vtableEntry)                                      \
 359                                                                           \
 360   declare_toplevel_type(oopDesc)                                          \
 361     declare_type(arrayOopDesc, oopDesc)                                   \
 362                                                                           \
 363   declare_toplevel_type(MetaspaceObj)                                     \
 364     declare_type(Metadata, MetaspaceObj)                                  \
 365     declare_type(Klass, Metadata)                                         \
 366       declare_type(InstanceKlass, Klass)                                  \
 367     declare_type(ConstantPool, Metadata)                                  \
 368 
 369 #define VM_INT_CONSTANTS(declare_constant, declare_constant_with_value, declare_preprocessor_constant) \
 370   declare_preprocessor_constant("ASSERT", DEBUG_ONLY(1) NOT_DEBUG(0))     \
 371   declare_preprocessor_constant("FIELDINFO_TAG_SIZE", FIELDINFO_TAG_SIZE) \
 372   declare_preprocessor_constant("STACK_BIAS", STACK_BIAS)                 \
 373                                                                           \
 374   declare_constant(CompLevel_none)                                        \
 375   declare_constant(CompLevel_simple)                                      \
 376   declare_constant(CompLevel_limited_profile)                             \
 377   declare_constant(CompLevel_full_profile)                                \
 378   declare_constant(CompLevel_full_optimization)                           \
 379   declare_constant(HeapWordSize)                                          \
 380   declare_constant(InvocationEntryBci)                                    \
 381   declare_constant(LogKlassAlignmentInBytes)                              \
 382                                                                           \
 383   declare_constant(JVM_ACC_WRITTEN_FLAGS)                                 \
 384   declare_constant(JVM_ACC_MONITOR_MATCH)                                 \
 385   declare_constant(JVM_ACC_HAS_MONITOR_BYTECODES)                         \
 386   declare_constant(JVM_ACC_HAS_FINALIZER)                                 \
 387   declare_constant(JVM_ACC_IS_CLONEABLE_FAST)                             \
 388   declare_constant(JVM_ACC_FIELD_INTERNAL)                                \
 389   declare_constant(JVM_ACC_FIELD_STABLE)                                  \
 390   declare_constant(JVM_ACC_FIELD_HAS_GENERIC_SIGNATURE)                   \
 391   declare_preprocessor_constant("JVM_ACC_VARARGS", JVM_ACC_VARARGS)       \
 392   declare_preprocessor_constant("JVM_ACC_BRIDGE", JVM_ACC_BRIDGE)         \
 393   declare_preprocessor_constant("JVM_ACC_ANNOTATION", JVM_ACC_ANNOTATION) \
 394   declare_preprocessor_constant("JVM_ACC_ENUM", JVM_ACC_ENUM)             \
 395   declare_preprocessor_constant("JVM_ACC_SYNTHETIC", JVM_ACC_SYNTHETIC)   \
 396                                                                           \
 397   declare_constant(JVM_CONSTANT_Utf8)                                     \
 398   declare_constant(JVM_CONSTANT_Unicode)                                  \
 399   declare_constant(JVM_CONSTANT_Integer)                                  \
 400   declare_constant(JVM_CONSTANT_Float)                                    \
 401   declare_constant(JVM_CONSTANT_Long)                                     \
 402   declare_constant(JVM_CONSTANT_Double)                                   \
 403   declare_constant(JVM_CONSTANT_Class)                                    \
 404   declare_constant(JVM_CONSTANT_String)                                   \
 405   declare_constant(JVM_CONSTANT_Fieldref)                                 \
 406   declare_constant(JVM_CONSTANT_Methodref)                                \
 407   declare_constant(JVM_CONSTANT_InterfaceMethodref)                       \
 408   declare_constant(JVM_CONSTANT_NameAndType)                              \
 409   declare_constant(JVM_CONSTANT_MethodHandle)                             \
 410   declare_constant(JVM_CONSTANT_MethodType)                               \
 411   declare_constant(JVM_CONSTANT_InvokeDynamic)                            \
 412   declare_constant(JVM_CONSTANT_ExternalMax)                              \
 413                                                                           \
 414   declare_constant(JVM_CONSTANT_Invalid)                                  \
 415   declare_constant(JVM_CONSTANT_InternalMin)                              \
 416   declare_constant(JVM_CONSTANT_UnresolvedClass)                          \
 417   declare_constant(JVM_CONSTANT_ClassIndex)                               \
 418   declare_constant(JVM_CONSTANT_StringIndex)                              \
 419   declare_constant(JVM_CONSTANT_UnresolvedClassInError)                   \
 420   declare_constant(JVM_CONSTANT_MethodHandleInError)                      \
 421   declare_constant(JVM_CONSTANT_MethodTypeInError)                        \
 422   declare_constant(JVM_CONSTANT_DynamicInError)                           \
 423   declare_constant(JVM_CONSTANT_InternalMax)                              \
 424                                                                           \
 425   declare_constant(ArrayData::array_len_off_set)                          \
 426   declare_constant(ArrayData::array_start_off_set)                        \
 427                                                                           \
 428   declare_constant(BitData::exception_seen_flag)                          \
 429   declare_constant(BitData::null_seen_flag)                               \
 430   declare_constant(BranchData::not_taken_off_set)                         \
 431                                                                           \
 432   declare_constant_with_value("CardTable::dirty_card", CardTable::dirty_card_val()) \
 433                                                                           \
 434   declare_constant(CodeInstaller::VERIFIED_ENTRY)                         \
 435   declare_constant(CodeInstaller::UNVERIFIED_ENTRY)                       \
 436   declare_constant(CodeInstaller::OSR_ENTRY)                              \
 437   declare_constant(CodeInstaller::EXCEPTION_HANDLER_ENTRY)                \
 438   declare_constant(CodeInstaller::DEOPT_HANDLER_ENTRY)                    \
 439   declare_constant(CodeInstaller::INVOKEINTERFACE)                        \
 440   declare_constant(CodeInstaller::INVOKEVIRTUAL)                          \
 441   declare_constant(CodeInstaller::INVOKESTATIC)                           \
 442   declare_constant(CodeInstaller::INVOKESPECIAL)                          \
 443   declare_constant(CodeInstaller::INLINE_INVOKE)                          \
 444   declare_constant(CodeInstaller::POLL_NEAR)                              \
 445   declare_constant(CodeInstaller::POLL_RETURN_NEAR)                       \
 446   declare_constant(CodeInstaller::POLL_FAR)                               \
 447   declare_constant(CodeInstaller::POLL_RETURN_FAR)                        \
 448   declare_constant(CodeInstaller::CARD_TABLE_SHIFT)                       \
 449   declare_constant(CodeInstaller::CARD_TABLE_ADDRESS)                     \
 450   declare_constant(CodeInstaller::HEAP_TOP_ADDRESS)                       \
 451   declare_constant(CodeInstaller::HEAP_END_ADDRESS)                       \
 452   declare_constant(CodeInstaller::NARROW_KLASS_BASE_ADDRESS)              \
 453   declare_constant(CodeInstaller::NARROW_OOP_BASE_ADDRESS)                \
 454   declare_constant(CodeInstaller::CRC_TABLE_ADDRESS)                      \
 455   declare_constant(CodeInstaller::LOG_OF_HEAP_REGION_GRAIN_BYTES)         \
 456   declare_constant(CodeInstaller::INLINE_CONTIGUOUS_ALLOCATION_SUPPORTED) \
 457   declare_constant(CodeInstaller::INVOKE_INVALID)                         \
 458                                                                           \
 459   declare_constant(ConstantPool::CPCACHE_INDEX_TAG)                       \
 460   declare_constant(ConstantPool::_has_dynamic_constant)                   \
 461                                                                           \
 462   declare_constant(ConstMethod::_has_linenumber_table)                    \
 463   declare_constant(ConstMethod::_has_localvariable_table)                 \
 464   declare_constant(ConstMethod::_has_exception_table)                     \
 465                                                                           \
 466   declare_constant(CounterData::count_off)                                \
 467                                                                           \
 468   declare_constant(DataLayout::cell_size)                                 \
 469   declare_constant(DataLayout::no_tag)                                    \
 470   declare_constant(DataLayout::bit_data_tag)                              \
 471   declare_constant(DataLayout::counter_data_tag)                          \
 472   declare_constant(DataLayout::jump_data_tag)                             \
 473   declare_constant(DataLayout::receiver_type_data_tag)                    \
 474   declare_constant(DataLayout::virtual_call_data_tag)                     \
 475   declare_constant(DataLayout::ret_data_tag)                              \
 476   declare_constant(DataLayout::branch_data_tag)                           \
 477   declare_constant(DataLayout::multi_branch_data_tag)                     \
 478   declare_constant(DataLayout::arg_info_data_tag)                         \
 479   declare_constant(DataLayout::call_type_data_tag)                        \
 480   declare_constant(DataLayout::virtual_call_type_data_tag)                \
 481   declare_constant(DataLayout::parameters_type_data_tag)                  \
 482   declare_constant(DataLayout::speculative_trap_data_tag)                 \
 483                                                                           \
 484   declare_constant(Deoptimization::Unpack_deopt)                          \
 485   declare_constant(Deoptimization::Unpack_exception)                      \
 486   declare_constant(Deoptimization::Unpack_uncommon_trap)                  \
 487   declare_constant(Deoptimization::Unpack_reexecute)                      \
 488                                                                           \
 489   declare_constant(Deoptimization::_action_bits)                          \
 490   declare_constant(Deoptimization::_reason_bits)                          \
 491   declare_constant(Deoptimization::_debug_id_bits)                        \
 492   declare_constant(Deoptimization::_action_shift)                         \
 493   declare_constant(Deoptimization::_reason_shift)                         \
 494   declare_constant(Deoptimization::_debug_id_shift)                       \
 495                                                                           \
 496   declare_constant(Deoptimization::Action_none)                           \
 497   declare_constant(Deoptimization::Action_maybe_recompile)                \
 498   declare_constant(Deoptimization::Action_reinterpret)                    \
 499   declare_constant(Deoptimization::Action_make_not_entrant)               \
 500   declare_constant(Deoptimization::Action_make_not_compilable)            \
 501                                                                           \
 502   declare_constant(Deoptimization::Reason_none)                           \
 503   declare_constant(Deoptimization::Reason_null_check)                     \
 504   declare_constant(Deoptimization::Reason_range_check)                    \
 505   declare_constant(Deoptimization::Reason_class_check)                    \
 506   declare_constant(Deoptimization::Reason_array_check)                    \
 507   declare_constant(Deoptimization::Reason_unreached0)                     \
 508   declare_constant(Deoptimization::Reason_constraint)                     \
 509   declare_constant(Deoptimization::Reason_div0_check)                     \
 510   declare_constant(Deoptimization::Reason_loop_limit_check)               \
 511   declare_constant(Deoptimization::Reason_type_checked_inlining)          \
 512   declare_constant(Deoptimization::Reason_optimized_type_check)           \
 513   declare_constant(Deoptimization::Reason_aliasing)                       \
 514   declare_constant(Deoptimization::Reason_transfer_to_interpreter)        \
 515   declare_constant(Deoptimization::Reason_not_compiled_exception_handler) \
 516   declare_constant(Deoptimization::Reason_unresolved)                     \
 517   declare_constant(Deoptimization::Reason_jsr_mismatch)                   \
 518   declare_constant(Deoptimization::Reason_LIMIT)                          \
 519                                                                           \
 520   declare_constant(FieldInfo::access_flags_offset)                        \
 521   declare_constant(FieldInfo::name_index_offset)                          \
 522   declare_constant(FieldInfo::signature_index_offset)                     \
 523   declare_constant(FieldInfo::initval_index_offset)                       \
 524   declare_constant(FieldInfo::low_packed_offset)                          \
 525   declare_constant(FieldInfo::high_packed_offset)                         \
 526   declare_constant(FieldInfo::field_slots)                                \
 527                                                                           \
 528   declare_constant(InstanceKlass::linked)                                 \
 529   declare_constant(InstanceKlass::fully_initialized)                      \
 530   declare_constant(InstanceKlass::_misc_is_unsafe_anonymous)              \
 531                                                                           \
 532   declare_constant(JumpData::taken_off_set)                               \
 533   declare_constant(JumpData::displacement_off_set)                        \
 534                                                                           \
 535   declare_constant(JVMCIEnv::ok)                                          \
 536   declare_constant(JVMCIEnv::dependencies_failed)                         \
 537   declare_constant(JVMCIEnv::dependencies_invalid)                        \
 538   declare_constant(JVMCIEnv::cache_full)                                  \
 539   declare_constant(JVMCIEnv::code_too_large)                              \
 540   declare_constant(JVMCIRuntime::none)                                    \
 541   declare_constant(JVMCIRuntime::by_holder)                               \
 542   declare_constant(JVMCIRuntime::by_full_signature)                       \
 543                                                                           \
 544   declare_constant(Klass::_lh_neutral_value)                              \
 545   declare_constant(Klass::_lh_instance_slow_path_bit)                     \
 546   declare_constant(Klass::_lh_log2_element_size_shift)                    \
 547   declare_constant(Klass::_lh_log2_element_size_mask)                     \
 548   declare_constant(Klass::_lh_element_type_shift)                         \
 549   declare_constant(Klass::_lh_element_type_mask)                          \
 550   declare_constant(Klass::_lh_header_size_shift)                          \
 551   declare_constant(Klass::_lh_header_size_mask)                           \
 552   declare_constant(Klass::_lh_array_tag_shift)                            \
 553   declare_constant(Klass::_lh_array_tag_type_value)                       \
 554   declare_constant(Klass::_lh_array_tag_obj_value)                        \
 555                                                                           \
 556   declare_constant(markOopDesc::no_hash)                                  \
 557                                                                           \
 558   declare_constant(Method::_caller_sensitive)                             \
 559   declare_constant(Method::_force_inline)                                 \
 560   declare_constant(Method::_dont_inline)                                  \
 561   declare_constant(Method::_hidden)                                       \
 562   declare_constant(Method::_intrinsic_candidate)                          \
 563   declare_constant(Method::_reserved_stack_access)                        \
 564                                                                           \
 565   declare_constant(Method::nonvirtual_vtable_index)                       \
 566   declare_constant(Method::invalid_vtable_index)                          \
 567                                                                           \
 568   declare_constant(MultiBranchData::per_case_cell_count)                  \
 569                                                                           \
 570   declare_constant(ReceiverTypeData::nonprofiled_count_off_set)           \
 571   declare_constant(ReceiverTypeData::receiver_type_row_cell_count)        \
 572   declare_constant(ReceiverTypeData::receiver0_offset)                    \
 573   declare_constant(ReceiverTypeData::count0_offset)                       \
 574                                                                           \
 575   declare_constant(vmIntrinsics::_invokeBasic)                            \
 576   declare_constant(vmIntrinsics::_linkToVirtual)                          \
 577   declare_constant(vmIntrinsics::_linkToStatic)                           \
 578   declare_constant(vmIntrinsics::_linkToSpecial)                          \
 579   declare_constant(vmIntrinsics::_linkToInterface)                        \
 580                                                                           \
 581   declare_constant(vmSymbols::FIRST_SID)                                  \
 582   declare_constant(vmSymbols::SID_LIMIT)                                  \
 583 
 584 #define VM_LONG_CONSTANTS(declare_constant, declare_preprocessor_constant) \
 585   declare_constant(InvocationCounter::count_increment)                    \
 586   declare_constant(InvocationCounter::count_shift)                        \
 587                                                                           \
 588   declare_constant(markOopDesc::hash_shift)                               \
 589                                                                           \
 590   declare_constant(markOopDesc::biased_lock_mask_in_place)                \
 591   declare_constant(markOopDesc::age_mask_in_place)                        \
 592   declare_constant(markOopDesc::epoch_mask_in_place)                      \
 593   declare_constant(markOopDesc::hash_mask)                                \
 594   declare_constant(markOopDesc::hash_mask_in_place)                       \
 595                                                                           \
 596   declare_constant(markOopDesc::unlocked_value)                           \
 597   declare_constant(markOopDesc::biased_lock_pattern)                      \
 598                                                                           \
 599   declare_constant(markOopDesc::no_hash_in_place)                         \
 600   declare_constant(markOopDesc::no_lock_in_place)                         \
 601 
 602 #define VM_ADDRESSES(declare_address, declare_preprocessor_address, declare_function) \
 603   declare_function(SharedRuntime::register_finalizer)                     \
 604   declare_function(SharedRuntime::exception_handler_for_return_address)   \
 605   declare_function(SharedRuntime::OSR_migration_end)                      \
 606   declare_function(SharedRuntime::enable_stack_reserved_zone)             \
 607   declare_function(SharedRuntime::frem)                                   \
 608   declare_function(SharedRuntime::drem)                                   \
 609                                                                           \
 610   declare_function(os::dll_load)                                          \
 611   declare_function(os::dll_lookup)                                        \
 612   declare_function(os::javaTimeMillis)                                    \
 613   declare_function(os::javaTimeNanos)                                     \
 614                                                                           \
 615   declare_function(Deoptimization::fetch_unroll_info)                     \
 616   declare_function(Deoptimization::uncommon_trap)                         \
 617   declare_function(Deoptimization::unpack_frames)                         \
 618                                                                           \
 619   declare_function(JVMCIRuntime::new_instance) \
 620   declare_function(JVMCIRuntime::new_array) \
 621   declare_function(JVMCIRuntime::new_multi_array) \
 622   declare_function(JVMCIRuntime::dynamic_new_array) \
 623   declare_function(JVMCIRuntime::dynamic_new_instance) \
 624   \
 625   declare_function(JVMCIRuntime::thread_is_interrupted) \
 626   declare_function(JVMCIRuntime::vm_message) \
 627   declare_function(JVMCIRuntime::identity_hash_code) \
 628   declare_function(JVMCIRuntime::exception_handler_for_pc) \
 629   declare_function(JVMCIRuntime::monitorenter) \
 630   declare_function(JVMCIRuntime::monitorexit) \
 631   declare_function(JVMCIRuntime::object_notify) \
 632   declare_function(JVMCIRuntime::object_notifyAll) \
 633   declare_function(JVMCIRuntime::throw_and_post_jvmti_exception) \
 634   declare_function(JVMCIRuntime::throw_klass_external_name_exception) \
 635   declare_function(JVMCIRuntime::throw_class_cast_exception) \
 636   declare_function(JVMCIRuntime::log_primitive) \
 637   declare_function(JVMCIRuntime::log_object) \
 638   declare_function(JVMCIRuntime::log_printf) \
 639   declare_function(JVMCIRuntime::vm_error) \
 640   declare_function(JVMCIRuntime::load_and_clear_exception) \
 641   G1GC_ONLY(declare_function(JVMCIRuntime::write_barrier_pre)) \
 642   G1GC_ONLY(declare_function(JVMCIRuntime::write_barrier_post)) \
 643   declare_function(JVMCIRuntime::validate_object) \
 644   \
 645   declare_function(JVMCIRuntime::test_deoptimize_call_int)
 646 
 647 
 648 #if INCLUDE_G1GC
 649 
 650 #define VM_STRUCTS_JVMCI_G1GC(nonstatic_field, static_field) \
 651   static_field(HeapRegion, LogOfHRGrainBytes, int)
 652 
 653 #define VM_INT_CONSTANTS_JVMCI_G1GC(declare_constant, declare_constant_with_value, declare_preprocessor_constant) \
 654   declare_constant_with_value("G1CardTable::g1_young_gen", G1CardTable::g1_young_card_val()) \
 655   declare_constant_with_value("G1ThreadLocalData::satb_mark_queue_active_offset", in_bytes(G1ThreadLocalData::satb_mark_queue_active_offset())) \
 656   declare_constant_with_value("G1ThreadLocalData::satb_mark_queue_index_offset", in_bytes(G1ThreadLocalData::satb_mark_queue_index_offset())) \
 657   declare_constant_with_value("G1ThreadLocalData::satb_mark_queue_buffer_offset", in_bytes(G1ThreadLocalData::satb_mark_queue_buffer_offset())) \
 658   declare_constant_with_value("G1ThreadLocalData::dirty_card_queue_index_offset", in_bytes(G1ThreadLocalData::dirty_card_queue_index_offset())) \
 659   declare_constant_with_value("G1ThreadLocalData::dirty_card_queue_buffer_offset", in_bytes(G1ThreadLocalData::dirty_card_queue_buffer_offset()))
 660 
 661 #endif // INCLUDE_G1GC
 662 
 663 
 664 #ifdef LINUX
 665 
 666 #define VM_ADDRESSES_OS(declare_address, declare_preprocessor_address, declare_function) \
 667   declare_preprocessor_address("RTLD_DEFAULT", RTLD_DEFAULT)
 668 
 669 #endif
 670 
 671 
 672 #ifdef BSD
 673 
 674 #define VM_ADDRESSES_OS(declare_address, declare_preprocessor_address, declare_function) \
 675   declare_preprocessor_address("RTLD_DEFAULT", RTLD_DEFAULT)
 676 
 677 #endif
 678 
 679 // AARCH64 is defined in closed port, too. TARGET_ARCH_aarch64 is not.
 680 #ifdef TARGET_ARCH_aarch64
 681 
 682 #define VM_STRUCTS_CPU(nonstatic_field, static_field, unchecked_nonstatic_field, volatile_nonstatic_field, nonproduct_nonstatic_field, c2_nonstatic_field, unchecked_c1_static_field, unchecked_c2_static_field) \
 683   volatile_nonstatic_field(JavaFrameAnchor, _last_Java_fp, intptr_t*)
 684 
 685 #define VM_INT_CONSTANTS_CPU(declare_constant, declare_preprocessor_constant, declare_c1_constant, declare_c2_constant, declare_c2_preprocessor_constant) \
 686   declare_constant(VM_Version::CPU_FP)                  \
 687   declare_constant(VM_Version::CPU_ASIMD)               \
 688   declare_constant(VM_Version::CPU_EVTSTRM)             \
 689   declare_constant(VM_Version::CPU_AES)                 \
 690   declare_constant(VM_Version::CPU_PMULL)               \
 691   declare_constant(VM_Version::CPU_SHA1)                \
 692   declare_constant(VM_Version::CPU_SHA2)                \
 693   declare_constant(VM_Version::CPU_CRC32)               \
 694   declare_constant(VM_Version::CPU_LSE)                 \
 695   declare_constant(VM_Version::CPU_STXR_PREFETCH)       \
 696   declare_constant(VM_Version::CPU_A53MAC)              \
 697   declare_constant(VM_Version::CPU_DMB_ATOMICS)
 698 
 699 #endif
 700 
 701 
 702 #ifdef X86
 703 
 704 #define VM_STRUCTS_CPU(nonstatic_field, static_field, unchecked_nonstatic_field, volatile_nonstatic_field, nonproduct_nonstatic_field, c2_nonstatic_field, unchecked_c1_static_field, unchecked_c2_static_field) \
 705   volatile_nonstatic_field(JavaFrameAnchor, _last_Java_fp, intptr_t*)
 706 
 707 #define VM_INT_CONSTANTS_CPU(declare_constant, declare_preprocessor_constant, declare_c1_constant, declare_c2_constant, declare_c2_preprocessor_constant) \
 708   LP64_ONLY(declare_constant(frame::arg_reg_save_area_bytes))       \
 709   declare_constant(frame::interpreter_frame_sender_sp_offset)       \
 710   declare_constant(frame::interpreter_frame_last_sp_offset)         \
 711   declare_constant(VM_Version::CPU_CX8)                             \
 712   declare_constant(VM_Version::CPU_CMOV)                            \
 713   declare_constant(VM_Version::CPU_FXSR)                            \
 714   declare_constant(VM_Version::CPU_HT)                              \
 715   declare_constant(VM_Version::CPU_MMX)                             \
 716   declare_constant(VM_Version::CPU_3DNOW_PREFETCH)                  \
 717   declare_constant(VM_Version::CPU_SSE)                             \
 718   declare_constant(VM_Version::CPU_SSE2)                            \
 719   declare_constant(VM_Version::CPU_SSE3)                            \
 720   declare_constant(VM_Version::CPU_SSSE3)                           \
 721   declare_constant(VM_Version::CPU_SSE4A)                           \
 722   declare_constant(VM_Version::CPU_SSE4_1)                          \
 723   declare_constant(VM_Version::CPU_SSE4_2)                          \
 724   declare_constant(VM_Version::CPU_POPCNT)                          \
 725   declare_constant(VM_Version::CPU_LZCNT)                           \
 726   declare_constant(VM_Version::CPU_TSC)                             \
 727   declare_constant(VM_Version::CPU_TSCINV)                          \
 728   declare_constant(VM_Version::CPU_AVX)                             \
 729   declare_constant(VM_Version::CPU_AVX2)                            \
 730   declare_constant(VM_Version::CPU_AES)                             \
 731   declare_constant(VM_Version::CPU_ERMS)                            \
 732   declare_constant(VM_Version::CPU_CLMUL)                           \
 733   declare_constant(VM_Version::CPU_BMI1)                            \
 734   declare_constant(VM_Version::CPU_BMI2)                            \
 735   declare_constant(VM_Version::CPU_RTM)                             \
 736   declare_constant(VM_Version::CPU_ADX)                             \
 737   declare_constant(VM_Version::CPU_AVX512F)                         \
 738   declare_constant(VM_Version::CPU_AVX512DQ)                        \
 739   declare_constant(VM_Version::CPU_AVX512PF)                        \
 740   declare_constant(VM_Version::CPU_AVX512ER)                        \
 741   declare_constant(VM_Version::CPU_AVX512CD)
 742 
 743 #define VM_LONG_CONSTANTS_CPU(declare_constant, declare_preprocessor_constant, declare_c1_constant, declare_c2_constant, declare_c2_preprocessor_constant) \
 744   declare_preprocessor_constant("VM_Version::CPU_AVX512BW", CPU_AVX512BW) \
 745   declare_preprocessor_constant("VM_Version::CPU_AVX512VL", CPU_AVX512VL) \
 746   declare_preprocessor_constant("VM_Version::CPU_SHA", CPU_SHA)           \
 747   declare_preprocessor_constant("VM_Version::CPU_FMA", CPU_FMA)           \
 748   declare_preprocessor_constant("VM_Version::CPU_VZEROUPPER", CPU_VZEROUPPER)
 749 
 750 #endif
 751 
 752 
 753 #ifdef SPARC
 754 
 755 #define VM_STRUCTS_CPU(nonstatic_field, static_field, unchecked_nonstatic_field, volatile_nonstatic_field, nonproduct_nonstatic_field, c2_nonstatic_field, unchecked_c1_static_field, unchecked_c2_static_field) \
 756   volatile_nonstatic_field(JavaFrameAnchor, _flags, int)
 757 
 758 #define VM_INT_CONSTANTS_CPU(declare_constant, declare_preprocessor_constant, declare_c1_constant, declare_c2_constant, declare_c2_preprocessor_constant) \
 759   declare_constant(VM_Version::ISA_V9)                  \
 760   declare_constant(VM_Version::ISA_POPC)                \
 761   declare_constant(VM_Version::ISA_VIS1)                \
 762   declare_constant(VM_Version::ISA_VIS2)                \
 763   declare_constant(VM_Version::ISA_BLK_INIT)            \
 764   declare_constant(VM_Version::ISA_FMAF)                \
 765   declare_constant(VM_Version::ISA_VIS3)                \
 766   declare_constant(VM_Version::ISA_HPC)                 \
 767   declare_constant(VM_Version::ISA_IMA)                 \
 768   declare_constant(VM_Version::ISA_AES)                 \
 769   declare_constant(VM_Version::ISA_DES)                 \
 770   declare_constant(VM_Version::ISA_KASUMI)              \
 771   declare_constant(VM_Version::ISA_CAMELLIA)            \
 772   declare_constant(VM_Version::ISA_MD5)                 \
 773   declare_constant(VM_Version::ISA_SHA1)                \
 774   declare_constant(VM_Version::ISA_SHA256)              \
 775   declare_constant(VM_Version::ISA_SHA512)              \
 776   declare_constant(VM_Version::ISA_MPMUL)               \
 777   declare_constant(VM_Version::ISA_MONT)                \
 778   declare_constant(VM_Version::ISA_PAUSE)               \
 779   declare_constant(VM_Version::ISA_CBCOND)              \
 780   declare_constant(VM_Version::ISA_CRC32C)              \
 781   declare_constant(VM_Version::ISA_VIS3B)               \
 782   declare_constant(VM_Version::ISA_ADI)                 \
 783   declare_constant(VM_Version::ISA_SPARC5)              \
 784   declare_constant(VM_Version::ISA_MWAIT)               \
 785   declare_constant(VM_Version::ISA_XMPMUL)              \
 786   declare_constant(VM_Version::ISA_XMONT)               \
 787   declare_constant(VM_Version::ISA_PAUSE_NSEC)          \
 788   declare_constant(VM_Version::ISA_VAMASK)              \
 789   declare_constant(VM_Version::ISA_SPARC6)              \
 790   declare_constant(VM_Version::ISA_DICTUNP)             \
 791   declare_constant(VM_Version::ISA_FPCMPSHL)            \
 792   declare_constant(VM_Version::ISA_RLE)                 \
 793   declare_constant(VM_Version::ISA_SHA3)                \
 794   declare_constant(VM_Version::ISA_VIS3C)               \
 795   declare_constant(VM_Version::ISA_SPARC5B)             \
 796   declare_constant(VM_Version::ISA_MME)                 \
 797   declare_constant(VM_Version::CPU_FAST_IDIV)           \
 798   declare_constant(VM_Version::CPU_FAST_RDPC)           \
 799   declare_constant(VM_Version::CPU_FAST_BIS)            \
 800   declare_constant(VM_Version::CPU_FAST_LD)             \
 801   declare_constant(VM_Version::CPU_FAST_CMOVE)          \
 802   declare_constant(VM_Version::CPU_FAST_IND_BR)         \
 803   declare_constant(VM_Version::CPU_BLK_ZEROING)
 804 #endif
 805 
 806 
 807 /*
 808  * Dummy defines for architectures that don't use these.
 809  */
 810 #ifndef VM_STRUCTS_CPU
 811 #define VM_STRUCTS_CPU(nonstatic_field, static_field, unchecked_nonstatic_field, volatile_nonstatic_field, nonproduct_nonstatic_field, c2_nonstatic_field, unchecked_c1_static_field, unchecked_c2_static_field)
 812 #endif
 813 
 814 #ifndef VM_TYPES_CPU
 815 #define VM_TYPES_CPU(declare_type, declare_toplevel_type, declare_oop_type, declare_integer_type, declare_unsigned_integer_type, declare_c1_toplevel_type, declare_c2_type, declare_c2_toplevel_type)
 816 #endif
 817 
 818 #ifndef VM_INT_CONSTANTS_CPU
 819 #define VM_INT_CONSTANTS_CPU(declare_constant, declare_preprocessor_constant, declare_c1_constant, declare_c2_constant, declare_c2_preprocessor_constant)
 820 #endif
 821 
 822 #ifndef VM_LONG_CONSTANTS_CPU
 823 #define VM_LONG_CONSTANTS_CPU(declare_constant, declare_preprocessor_constant, declare_c1_constant, declare_c2_constant, declare_c2_preprocessor_constant)
 824 #endif
 825 
 826 #ifndef VM_STRUCTS_OS
 827 #define VM_STRUCTS_OS(nonstatic_field, static_field, unchecked_nonstatic_field, volatile_nonstatic_field, nonproduct_nonstatic_field, c2_nonstatic_field, unchecked_c1_static_field, unchecked_c2_static_field)
 828 #endif
 829 
 830 #ifndef VM_TYPES_OS
 831 #define VM_TYPES_OS(declare_type, declare_toplevel_type, declare_oop_type, declare_integer_type, declare_unsigned_integer_type, declare_c1_toplevel_type, declare_c2_type, declare_c2_toplevel_type)
 832 #endif
 833 
 834 #ifndef VM_INT_CONSTANTS_OS
 835 #define VM_INT_CONSTANTS_OS(declare_constant, declare_preprocessor_constant, declare_c1_constant, declare_c2_constant, declare_c2_preprocessor_constant)
 836 #endif
 837 
 838 #ifndef VM_LONG_CONSTANTS_OS
 839 #define VM_LONG_CONSTANTS_OS(declare_constant, declare_preprocessor_constant, declare_c1_constant, declare_c2_constant, declare_c2_preprocessor_constant)
 840 #endif
 841 
 842 #ifndef VM_ADDRESSES_OS
 843 #define VM_ADDRESSES_OS(declare_address, declare_preprocessor_address, declare_function)
 844 #endif
 845 
 846 
 847 //
 848 // Instantiation of VMStructEntries, VMTypeEntries and VMIntConstantEntries
 849 //
 850 
 851 // These initializers are allowed to access private fields in classes
 852 // as long as class VMStructs is a friend
 853 VMStructEntry JVMCIVMStructs::localHotSpotVMStructs[] = {
 854   VM_STRUCTS(GENERATE_NONSTATIC_VM_STRUCT_ENTRY,
 855              GENERATE_STATIC_VM_STRUCT_ENTRY,
 856              GENERATE_UNCHECKED_NONSTATIC_VM_STRUCT_ENTRY,
 857              GENERATE_NONSTATIC_VM_STRUCT_ENTRY)
 858 
 859   VM_STRUCTS_OS(GENERATE_NONSTATIC_VM_STRUCT_ENTRY,
 860                 GENERATE_STATIC_VM_STRUCT_ENTRY,
 861                 GENERATE_UNCHECKED_NONSTATIC_VM_STRUCT_ENTRY,
 862                 GENERATE_NONSTATIC_VM_STRUCT_ENTRY,
 863                 GENERATE_NONPRODUCT_NONSTATIC_VM_STRUCT_ENTRY,
 864                 GENERATE_C2_NONSTATIC_VM_STRUCT_ENTRY,
 865                 GENERATE_C1_UNCHECKED_STATIC_VM_STRUCT_ENTRY,
 866                 GENERATE_C2_UNCHECKED_STATIC_VM_STRUCT_ENTRY)
 867 
 868   VM_STRUCTS_CPU(GENERATE_NONSTATIC_VM_STRUCT_ENTRY,
 869                  GENERATE_STATIC_VM_STRUCT_ENTRY,
 870                  GENERATE_UNCHECKED_NONSTATIC_VM_STRUCT_ENTRY,
 871                  GENERATE_NONSTATIC_VM_STRUCT_ENTRY,
 872                  GENERATE_NONPRODUCT_NONSTATIC_VM_STRUCT_ENTRY,
 873                  GENERATE_C2_NONSTATIC_VM_STRUCT_ENTRY,
 874                  GENERATE_C1_UNCHECKED_STATIC_VM_STRUCT_ENTRY,
 875                  GENERATE_C2_UNCHECKED_STATIC_VM_STRUCT_ENTRY)
 876 
 877 #if INCLUDE_G1GC
 878   VM_STRUCTS_JVMCI_G1GC(GENERATE_NONSTATIC_VM_STRUCT_ENTRY,
 879                         GENERATE_STATIC_VM_STRUCT_ENTRY)
 880 #endif
 881 
 882   GENERATE_VM_STRUCT_LAST_ENTRY()
 883 };
 884 
 885 VMTypeEntry JVMCIVMStructs::localHotSpotVMTypes[] = {
 886   VM_TYPES(GENERATE_VM_TYPE_ENTRY,
 887            GENERATE_TOPLEVEL_VM_TYPE_ENTRY,
 888            GENERATE_INTEGER_VM_TYPE_ENTRY,
 889            GENERATE_UNSIGNED_INTEGER_VM_TYPE_ENTRY)
 890 
 891   VM_TYPES_OS(GENERATE_VM_TYPE_ENTRY,
 892               GENERATE_TOPLEVEL_VM_TYPE_ENTRY,
 893               GENERATE_OOP_VM_TYPE_ENTRY,
 894               GENERATE_INTEGER_VM_TYPE_ENTRY,
 895               GENERATE_UNSIGNED_INTEGER_VM_TYPE_ENTRY,
 896               GENERATE_C1_TOPLEVEL_VM_TYPE_ENTRY,
 897               GENERATE_C2_VM_TYPE_ENTRY,
 898               GENERATE_C2_TOPLEVEL_VM_TYPE_ENTRY)
 899 
 900   VM_TYPES_CPU(GENERATE_VM_TYPE_ENTRY,
 901                GENERATE_TOPLEVEL_VM_TYPE_ENTRY,
 902                GENERATE_OOP_VM_TYPE_ENTRY,
 903                GENERATE_INTEGER_VM_TYPE_ENTRY,
 904                GENERATE_UNSIGNED_INTEGER_VM_TYPE_ENTRY,
 905                GENERATE_C1_TOPLEVEL_VM_TYPE_ENTRY,
 906                GENERATE_C2_VM_TYPE_ENTRY,
 907                GENERATE_C2_TOPLEVEL_VM_TYPE_ENTRY)
 908 
 909   GENERATE_VM_TYPE_LAST_ENTRY()
 910 };
 911 
 912 VMIntConstantEntry JVMCIVMStructs::localHotSpotVMIntConstants[] = {
 913   VM_INT_CONSTANTS(GENERATE_VM_INT_CONSTANT_ENTRY,
 914                    GENERATE_VM_INT_CONSTANT_WITH_VALUE_ENTRY,
 915                    GENERATE_PREPROCESSOR_VM_INT_CONSTANT_ENTRY)
 916 
 917   VM_INT_CONSTANTS_OS(GENERATE_VM_INT_CONSTANT_ENTRY,
 918                       GENERATE_PREPROCESSOR_VM_INT_CONSTANT_ENTRY,
 919                       GENERATE_C1_VM_INT_CONSTANT_ENTRY,
 920                       GENERATE_C2_VM_INT_CONSTANT_ENTRY,
 921                       GENERATE_C2_PREPROCESSOR_VM_INT_CONSTANT_ENTRY)
 922 
 923   VM_INT_CONSTANTS_CPU(GENERATE_VM_INT_CONSTANT_ENTRY,
 924                        GENERATE_PREPROCESSOR_VM_INT_CONSTANT_ENTRY,
 925                        GENERATE_C1_VM_INT_CONSTANT_ENTRY,
 926                        GENERATE_C2_VM_INT_CONSTANT_ENTRY,
 927                        GENERATE_C2_PREPROCESSOR_VM_INT_CONSTANT_ENTRY)
 928 
 929 #if INCLUDE_G1GC
 930   VM_INT_CONSTANTS_JVMCI_G1GC(GENERATE_VM_INT_CONSTANT_ENTRY,
 931                               GENERATE_VM_INT_CONSTANT_WITH_VALUE_ENTRY,
 932                               GENERATE_PREPROCESSOR_VM_INT_CONSTANT_ENTRY)
 933 #endif
 934 
 935   GENERATE_VM_INT_CONSTANT_LAST_ENTRY()
 936 };
 937 
 938 VMLongConstantEntry JVMCIVMStructs::localHotSpotVMLongConstants[] = {
 939   VM_LONG_CONSTANTS(GENERATE_VM_LONG_CONSTANT_ENTRY,
 940                     GENERATE_PREPROCESSOR_VM_LONG_CONSTANT_ENTRY)
 941 
 942   VM_LONG_CONSTANTS_OS(GENERATE_VM_LONG_CONSTANT_ENTRY,
 943                        GENERATE_PREPROCESSOR_VM_LONG_CONSTANT_ENTRY,
 944                        GENERATE_C1_VM_LONG_CONSTANT_ENTRY,
 945                        GENERATE_C2_VM_LONG_CONSTANT_ENTRY,
 946                        GENERATE_C2_PREPROCESSOR_VM_LONG_CONSTANT_ENTRY)
 947 
 948   VM_LONG_CONSTANTS_CPU(GENERATE_VM_LONG_CONSTANT_ENTRY,
 949                         GENERATE_PREPROCESSOR_VM_LONG_CONSTANT_ENTRY,
 950                         GENERATE_C1_VM_LONG_CONSTANT_ENTRY,
 951                         GENERATE_C2_VM_LONG_CONSTANT_ENTRY,
 952                         GENERATE_C2_PREPROCESSOR_VM_LONG_CONSTANT_ENTRY)
 953 
 954   GENERATE_VM_LONG_CONSTANT_LAST_ENTRY()
 955 };
 956 
 957 VMAddressEntry JVMCIVMStructs::localHotSpotVMAddresses[] = {
 958   VM_ADDRESSES(GENERATE_VM_ADDRESS_ENTRY,
 959                GENERATE_PREPROCESSOR_VM_ADDRESS_ENTRY,
 960                GENERATE_VM_FUNCTION_ENTRY)
 961   VM_ADDRESSES_COMPILER_RUNTIME(GENERATE_VM_ADDRESS_ENTRY,
 962                GENERATE_PREPROCESSOR_VM_ADDRESS_ENTRY,
 963                GENERATE_VM_FUNCTION_ENTRY)
 964   VM_ADDRESSES_OS(GENERATE_VM_ADDRESS_ENTRY,
 965                   GENERATE_PREPROCESSOR_VM_ADDRESS_ENTRY,
 966                   GENERATE_VM_FUNCTION_ENTRY)
 967 
 968   GENERATE_VM_ADDRESS_LAST_ENTRY()
 969 };
 970 
 971 int JVMCIVMStructs::localHotSpotVMStructs_count() {
 972   // Ignore sentinel entry at the end
 973   return (sizeof(localHotSpotVMStructs) / sizeof(VMStructEntry)) - 1;
 974 }
 975 int JVMCIVMStructs::localHotSpotVMTypes_count() {
 976   // Ignore sentinel entry at the end
 977   return (sizeof(localHotSpotVMTypes) / sizeof(VMTypeEntry)) - 1;
 978 }
 979 int JVMCIVMStructs::localHotSpotVMIntConstants_count() {
 980   // Ignore sentinel entry at the end
 981   return (sizeof(localHotSpotVMIntConstants) / sizeof(VMIntConstantEntry)) - 1;
 982 }
 983 int JVMCIVMStructs::localHotSpotVMLongConstants_count() {
 984   // Ignore sentinel entry at the end
 985   return (sizeof(localHotSpotVMLongConstants) / sizeof(VMLongConstantEntry)) - 1;
 986 }
 987 int JVMCIVMStructs::localHotSpotVMAddresses_count() {
 988   // Ignore sentinel entry at the end
 989   return (sizeof(localHotSpotVMAddresses) / sizeof(VMAddressEntry)) - 1;
 990 }
 991 
 992 extern "C" {
 993 JNIEXPORT VMStructEntry* jvmciHotSpotVMStructs = JVMCIVMStructs::localHotSpotVMStructs;
 994 JNIEXPORT VMTypeEntry* jvmciHotSpotVMTypes = JVMCIVMStructs::localHotSpotVMTypes;
 995 JNIEXPORT VMIntConstantEntry* jvmciHotSpotVMIntConstants = JVMCIVMStructs::localHotSpotVMIntConstants;
 996 JNIEXPORT VMLongConstantEntry* jvmciHotSpotVMLongConstants = JVMCIVMStructs::localHotSpotVMLongConstants;
 997 JNIEXPORT VMAddressEntry* jvmciHotSpotVMAddresses = JVMCIVMStructs::localHotSpotVMAddresses;
 998 }
</pre></body></html>
